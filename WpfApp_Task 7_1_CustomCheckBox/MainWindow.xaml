<Window x:Class="WpfApp_Task_7_1_CustomCheckBox.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp_Task_7_1_CustomCheckBox"
        mc:Ignorable="d"
        Title="Кастомный чекбокс" Height="150" Width="300">
    <Window.Resources>
        <Style x:Key="ThreeStateCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Width="80">
                            <Grid Width="20" Height="20" HorizontalAlignment="Center">
                                <!-- Прямоугольник -->
                                <Rectangle Fill="White" 
                                           Stroke="Black"
                                           RadiusX="3" RadiusY="3"/>

                                <!-- Буква X -->
                                <TextBlock x:Name="CheckMark" 
                                           Text="X" 
                                           FontWeight="Bold" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Opacity="0"/>

                                <!-- Круг -->
                                <Ellipse x:Name="IndeterminateMark" 
                                         Width="8" Height="8" 
                                         Fill="Black"
                                         HorizontalAlignment="Center" 
                                         VerticalAlignment="Center"
                                         Opacity="0"/>
                            </Grid>

                            <!-- Текст -->
                            <ContentPresenter VerticalAlignment="Bottom" 
                                              HorizontalAlignment="Center"
                                              Margin="0,35,0,0"/>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <!-- Checked -->
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Opacity" Value="1"/>
                                <Setter Property="Content" Value="Checked"/>
                            </Trigger>

                            <!-- Indeterminate -->
                            <Trigger Property="IsChecked" Value="{x:Null}">
                                <Setter TargetName="IndeterminateMark" Property="Opacity" Value="1"/>
                                <Setter Property="Content" Value="Indeterminate"/>
                            </Trigger>

                            <!-- Unchecked -->
                            <Trigger Property="IsChecked" Value="False">
                                <Setter Property="Content" Value="Unchecked"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
            <!-- Unchecked -->
            <CheckBox Style="{StaticResource ThreeStateCheckBoxStyle}" 
                      IsChecked="False"
                      IsThreeState="True"/>

            <!-- Checked -->
            <CheckBox Style="{StaticResource ThreeStateCheckBoxStyle}" 
                      IsChecked="True"
                      IsThreeState="True"/>

            <!-- Indeterminate -->
            <CheckBox Style="{StaticResource ThreeStateCheckBoxStyle}" 
                      IsChecked="{x:Null}"
                      IsThreeState="True"/>
        </StackPanel>
    </StackPanel>
</Window>